# Multi-Scale GNN Configuration
# This single config file is used for all modes (train/valid/rollout)
# to ensure consistency between training and inference

# Mode & Paths
# mode: 'train', 'valid', or 'rollout'
# - train: Train a new model (set model_file to null or to resume from checkpoint)
# - valid: Validate trained model on validation set (requires model_file)
# - rollout: Generate predictions on test set (requires model_file)
mode: rollout
data_path: "./datasets/taylor_impact_2d/data_processed/"
model_path: "./models/multi_scale/"
output_path: "./rollouts/multi_scale/"

# Multi-Scale Parameters
num_scales: 2
window_size: 2
radius_multiplier: 2.0

# Model Parameters
layers: 10
hidden_dim: 128
dim: 2
particle_type_embedding_size: 9
input_sequence_length: 11

# Training Parameters
batch_size: 16
noise_std: 0.02
ntraining_steps: 50000
nsave_steps: 2000  # Validation frequency (model saved only if better)

# Loss Weights
loss_weight_position: 1.0  # Weight for position/acceleration loss
loss_weight_strain: 1.0    # Weight for strain loss

# Learning Rate
lr_init: 0.001
lr_decay: 0.1
lr_decay_steps: 15000

# Logging
log: True
project_name: "Taylor_impact_2d"
run_name: "2-2-2-10-128-11-noStrain"

# Model Loading (required for 'valid' and 'rollout' modes)
# For rollout/validation: set to trained model filename (e.g., 'model-final-000010.pt' or 'model-best-001000.pt')
# For training: set to null (trains from scratch) or specify to resume training
model_file: "model-best-002000.pt"  # Example: "model-final-000010.pt" for rollout mode
train_state_file: null

# Inference
inference_mode: autoregressive
debug_graph: True


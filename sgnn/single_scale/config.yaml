# Single-Scale GNN Configuration
# This config file is used for all modes (train/valid/rollout)
# to ensure consistency between training and inference

# Mode & Paths
# mode: 'train', 'valid', or 'rollout'
# - train: Train a new model (set model_file to null or to resume from checkpoint)
# - valid: Validate trained model on validation set (requires model_file)
# - rollout: Generate predictions on test set (requires model_file)
mode: train
data_path: "./datasets/taylor_impact_2d/data_processed/"
model_path: "./models/single_scale/"
output_path: "./rollouts/single_scale/"

# Model Parameters
layers: 5
hidden_dim: 64
dim: 2
particle_type_embedding_size: 9
input_sequence_length: 11
connection_radius: 0.6

# Training Parameters
batch_size: 32
noise_std: 0.02
ntraining_steps: 100000
nsave_steps: 2000  # Validation frequency (model saved only if better)

# Loss Weights
loss_weight_position: 1.0  # Weight for position/acceleration loss
loss_weight_strain: 1.0    # Weight for strain loss

# Learning Rate
lr_init: 0.001
lr_decay: 0.1
lr_decay_steps: 30000

# Logging
log: False
project_name: "Taylor_impact_2d"
run_name: "single_scale_default"

# Model Loading (required for 'valid' and 'rollout' modes)
# For rollout/validation: set to trained model filename (e.g., 'model-final-000010.pt' or 'model-best-001000.pt')
# For training: set to null (trains from scratch) or specify to resume training
model_file: null  # Example: "model-final-000010.pt" for rollout mode
train_state_file: "train_state.pt"

# Inference
inference_mode: autoregressive
debug_graph: false
